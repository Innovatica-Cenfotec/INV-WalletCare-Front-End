<nz-modal [nzTitle]="getTitle()" [nzVisible]="isVisible" [nzOkLoading]="isLoading" (nzOnCancel)="handleCancel()"
    [nzCancelLoading]="isLoading">
    <div *nzModalContent>      
        <form nz-form [nzLayout]="'vertical'" [formGroup]="formGroup">
            <nz-form-item>
                <nz-form-label nzRequired nzFor="selected">{{getPleaceholder()}}</nz-form-label>
                <nz-form-control [nzErrorTip]="getErrorMessage()">
                    <nz-select formControlName="selected" nzShowSearch nzAllowClear nzPlaceHolder="{{getPleaceholder()}}"
                        (ngModelChange)="onSelectItem($event)">
                        @if (type=="income") {
                        <nz-option *ngFor="let option of listIncome" [nzLabel]="option.name"
                            [nzValue]="option"></nz-option>
                        }
                        @if (type=="expense") {
                        <nz-option *ngFor="let option of listExpense" [nzLabel]="option.name"
                            [nzValue]="option"></nz-option>
                        }
                    </nz-select>
                </nz-form-control>
            </nz-form-item>

            @if (selectedItem != null){
            <nz-descriptions nzTitle="Información general" nzBordered nzLayout="vertical" [nzColumn]="4"
                [nzSize]="'small'">
                <nz-descriptions-item nzTitle="Monto">{{this.selectedItem.amount}}</nz-descriptions-item>
                <nz-descriptions-item nzTitle="¿Es neto?">{{getAmountType(this.selectedItem)}}</nz-descriptions-item>
                <nz-descriptions-item nzTitle="Tipo">{{getType(this.selectedItem)}}</nz-descriptions-item>

                @if (this.selectedItem.frequency) {
                <nz-descriptions-item nzTitle="Frecuencia">{{getFrequency(this.selectedItem)}}</nz-descriptions-item>
                <nz-descriptions-item *ngIf="this.selectedItem.frequency == 'OTHER'"
                    nzTitle="Día programado">{{this.selectedItem.scheduledDay}}</nz-descriptions-item>
                }

                @if (this.selectedItem.Tax != null){
                <nz-descriptions-item nzTitle="Impuesto">{{this.selectedItem.Tax.name}}</nz-descriptions-item>
                <nz-descriptions-item nzTitle="Porcentaje">{{this.selectedItem.Tax.percentage}}</nz-descriptions-item>
                }

                <nz-descriptions-item nzTitle="Descripción">
                    <p>{{this.selectedItem.description}}</p>
                </nz-descriptions-item>
            </nz-descriptions>
            }
        </form>
    </div>
    <div *nzModalFooter>
        <button nz-button nzType="default" [disabled]="isLoading" (click)="handleCancel()">Cancelar</button>
        <button nz-button nzType="primary" [nzLoading]="isLoading" (click)="handleConfirm()">
            @if (type=="income") {
            {{this.selectedItem.frequency == null ? 'Agregar' : 'Activar ingreso recurrente'}}
            }
            @if ( type=="expense" ) {
            {{this.selectedItem.frequency == null ? 'Agregar' : 'Activar gasto recurrente'}}
            }
        </button>
    </div>
</nz-modal>